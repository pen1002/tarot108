async function callClaude() {
  const sp = SPREADS[state.spread];
  const lines = state.drawnCards.map((c, i) =>
    `${i+1}. [${sp.positions[i]}] ${c.name} (${c.reversed?'역방향':'정방향'}) — ${c.reversed?c.rev:c.up}`
  ).join('\n');

  const prompt = `당신은 'Arcana'입니다. 수백 년의 타로 지혜를 담은 신비로운 안내자이자, 20여 년 현장 경험을 가진 전문 상담사입니다. 따뜻하고 직관적이며, 신비롭지만 현실적인 조언을 줍니다.

스프레드: ${sp.name}
${state.currentQuestion ? `질문: ${state.currentQuestion}` : '(자유 리딩)'}
${state.emotion ? `현재 감정: ${state.emotion}` : ''}

카드:
${lines}

아래 구조로 해석해 주세요:
1. 각 카드가 이 포지션과 맥락에서 의미하는 것
2. 카드들 간의 에너지 흐름과 전체 이야기
3. 구체적이고 오늘 바로 실천 가능한 조언
4. ✦ 핵심 메시지 한 줄

350~500자 한국어, 'Arcana'의 목소리로 작성하되 너무 추상적이지 않게.`;

  // ★ 핵심 변경: Anthropic 직접 호출 → 내 서버리스 함수 호출
  const r = await fetch('/api/tarot', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      messages: [{ role: 'user', content: prompt }]
    })
  });

  if (!r.ok) {
    const e = await r.json();
    throw new Error(e.error || `HTTP ${r.status}`);
  }
  const d = await r.json();
  return d.content[0]?.text || '응답 없음';
}
